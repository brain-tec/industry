<?xml version='1.0' encoding='UTF-8'?>
<odoo noupdate="1">
    <record id="excises_tax_group" model="account.tax.group">
        <field name="name">Excises</field>
        <field name="x_is_excise" eval="True"/>
    </record>
    <function model="account.fiscal.position" name="write">
        <value model="account.fiscal.position" eval="obj().search([]).ids"/>
        <value eval="{'x_is_fiscal_deposit': True}"/>
    </function>

    <record id="no_excise_tax_sale" model="account.tax">
        <field name="name">No Excises</field>
        <field name="amount_type">fixed</field>
        <field name="amount">0</field>
        <field name="type_tax_use">sale</field>
        <field name="tax_group_id" ref="excises_tax_group"/>
        <field name="fiscal_position_ids" model="account.fiscal.position" eval="[Command.link(fp) for fp in obj().search([('x_is_fiscal_deposit', '=', True)]).ids]"/>
    </record>
    <record id="no_excise_tax_purchase" model="account.tax">
        <field name="name">No Excises</field>
        <field name="amount_type">fixed</field>
        <field name="amount">0</field>
        <field name="type_tax_use">purchase</field>
        <field name="tax_group_id" ref="excises_tax_group"/>
        <field name="fiscal_position_ids" model="account.fiscal.position" eval="[Command.link(fp) for fp in obj().search([('x_is_fiscal_deposit', '=', True)]).ids]"/>
    </record>

    <function name="write" model="account.tax">
        <value eval="[ref('no_excise_tax_sale'), ref('no_excise_tax_purchase')]"/>
        <value model="account.tax" eval="
            {'ubl_cii_tax_category_code': 'Z'}
            if obj().env['ir.module.module'].search_count([
                ('name', '=', 'account_edi_ubl_cii'),
                ('state', '=', 'installed')
            ], limit=1)
            else {}
        "/>
    </function>
</odoo>
